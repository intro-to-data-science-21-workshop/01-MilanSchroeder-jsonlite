---
title: "Workshop 1: Working with JSON & jsonlite"
author: "[Sangeeth Selvaraju](https://github.com/RajaSangeeth) & [Milan Schr√∂der](https://github.com/milanschroeder)"
institute: "Hertie School | [Intro to Data Science Workshop](https://github.com/intro-to-data-science-21-workshop)"
output: 
  xaringan::moon_reader:
    ioslides_presentation:
      incremental: true
      self_contained: true
      widescreen: true
      smaller: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      eval = TRUE,
                      error = FALSE,
                      message = FALSE,
                      warning = FALSE,
                      comment = " ",
                      prompt = TRUE,
                      fig.align="center", #fig.width=6, fig.height=4.5, 
                      # out.width="748px", #out.length="520.75px",
                      dpi=300, #fig.path='Figs/',
                      cache=F, #echo=F, warning=F, message=F
                      engine.opts = list(bash = "-l"))

library(pacman)
p_load(xaringan, jsonlite, tidyverse)
```

# Intro

## 1st slide
- What is JSON?

- History of the package

---
#Intro
## 2nd slide
- Benefits of using JSON

- Where is it used?

---
# Data Structures in JSON

- object
  - unordered list of key : value pairs
  - similar to a dictionary
  - can include all types of JSON structures
  
  
- array
  - ordered sequence of values
  - similar to R's vector-class
  - datatype can be heterogeneous


- value
  - no direct representation in R
  - some are similar to vector of length 1
  - values can be nested

---
# object
<img src="https://www.json.org/img/object.png" height=440>
---
# array
<img src="https://www.json.org/img/array.png" heght=440>
---
# value
<img src="https://www.json.org/img/value.png" heght=440>

---

# Key functions: `fromJSON`

```{r fromJSON}
workshops = fromJSON("https://api.github.com/orgs/intro-to-data-science-21-workshop/repos")

workshops %>% 
  filter(!is.na(description)) %>% 
  select(description)
# Make sure to check out the other workshops, too!
```

---

# Key functions: `toJSON`

```{r toJSON}
starwars %>% slice_sample(n = 2) %>% 
  toJSON(pretty = T)
```

---

R knows different `NA`-values, but JSON only has `null` to represent those...

- By default, `NA`'s are treated as strings (in numeric vectors)
  - so the string is no longer homogeneous, cause errors in statistical operations
  - but all information is preserved 
  
```{r}
(toJSON(c(3.14, NA, NaN, 21, Inf, -Inf)))
```
  
- You can choose to represent them as null
  - keeping the vector numeric
  - but loosing information

```{r}
(toJSON(c(3.14, NA, NaN, 21, Inf, -Inf), na = "null"))

```



---

## Changing back and forth

- Note that there is no guaranteed one-to-one correspondence of R and JSON objects:
  - it will still be the encoded data
  - but ordering, class, etc. may differ

```{r}
(example <- slice_sample(starwars, n = 2))
fromJSON(toJSON(example))
```

if you - for whatever reason - need it to be consistent, use `(un)serializeJSON` instead
```{r}
unserializeJSON(serializeJSON(example))
```

But the downside is that the JSON structure has to be much harder to read (or transfer to other languages), to perfectly resemble the original...

```{r}
serializeJSON(example)
```


---
# Practice Example

```{r example}
# Pokedex_JSON
# Pokedex_df

# some_funny_analysis
```

