<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Workshop 1: Working with JSON &amp; jsonlite</title>
    <meta charset="utf-8" />
    <meta name="author" content="Sangeeth Selvaraju &amp; Milan Schröder" />
    <script src="01-WorkshopSlides-jsonlite_files/header-attrs-2.9/header-attrs.js"></script>
    <link href="01-WorkshopSlides-jsonlite_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="01-WorkshopSlides-jsonlite_files/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Workshop 1: Working with JSON &amp; jsonlite
### <a href="https://github.com/RajaSangeeth">Sangeeth Selvaraju</a> &amp; <a href="https://github.com/milanschroeder">Milan Schröder</a>
### Hertie School | <a href="https://github.com/intro-to-data-science-21-workshop">Intro to Data Science Workshop</a>

---




# Intro

## 1st slide
- What is JSON?

- History of the package

---
#Intro
## 2nd slide
- Benefits of using JSON

- Where is it used?

---
# Data Structures in JSON

- object
  - unordered list of key : value pairs
  - similar to a dictionary
  - can include all types of JSON structures
  
  
- array
  - ordered sequence of values
  - similar to R's vector-class
  - datatype can be heterogeneous


- value
  - no direct representation in R
  - some are similar to vector of length 1
  - values can be nested

---
# object
&lt;img src="https://www.json.org/img/object.png" height=440&gt;
---
# array
&lt;img src="https://www.json.org/img/array.png" heght=440&gt;
---
# value
&lt;img src="https://www.json.org/img/value.png" heght=440&gt;

---

# Key functions: `fromJSON`


```r
&gt; workshops = fromJSON("https://api.github.com/orgs/intro-to-data-science-21-workshop/repos")
&gt; 
&gt; workshops %&gt;% 
+   filter(!is.na(description)) %&gt;% 
+   select(description)
```

```
                                                                                                                                                                                                                                                                                                                                       description
  1                                                                                                                                                                                                                                                                                                 How to create interactive graphics with plotly
  2                                                                                  This repository provides materials for a session that is part of the IDS Tools for Data Science workshop run at the Hertie School Berlin in November 2021. This workshop-session you new insights into working with Coordinate Reference Systems (CRS) in R. 
  3                                                                                                                                                                                                                                                                                                         A template repository for the workshop
  4                                                                                                                                                                                                                                                                                               Frontend of I2DS Tools for Data Science Workshop
  5                                                                               This repository introduces you to the basics of the quanteda package, presented by Laura Menicacci and Dinah Rabe in the context of the Introduction for Data Science workshop, organised by Prof. Simon Munzert at the Hertie School (Berlin) in November 2021.
  6                                                                                                                                                                                                                  Together with my classmate Claudia Zwar, we will introduce you to the package Janitor and its functions to clean dirty data. 
  7  This short student-run workshop is part of the course I2DS Tools for Data Science workshop at the Hertie School, Berlin taught by Simon Munzert at the Hertie School, Berlin, Fall-Semester 2021. It is taking place in November 2021. This particular workshop will teach how to work with dates and times using the Lubridate package in R.
  8                                                                                                                                            This repository provides materials for the session on Regular Expressions with Stringr that is part of the I2DS Tools for Data Science workshop run at the Hertie School, Berlin in November 2021. 
  9                                                                                                                                                                                                                                                                                Inroduction to creating web APIs in R using the plumber package
  10                                                                                                                                                                                                                                                           Regular expressions with stringr – A workshop from Anna-Lisa Wirth and Lukas Warode
  11                                                                                                            This repository, organized by Andrew Wells and Fernanda Candido Gomes, provides materials for the session "Geocoding with SF", part of the I2DS Tools for Data Science workshop run at the Hertie School, Berlin in November 2021.
  12                                                                                                                                                                                                                                                                               This workshop covers network graphs using ggraph and tidygraph.
  13                                                                                                                                                                                                                                           Intro to working with categorical variables in R using forcats by Janine De Vera and Victor Möslein
  14                                                                                                                                                                                                     Workshop presentation on analyzing temporal data with Tsibble, by Kabir Sandrolini &amp; Maren Rieker, students at the Hertie School, Berlin.
  15                                                                                                                                                                                                This repository provides materials for a workshop presentation on "Interactive maps with leaflet" presented by Florian Winkler and Jiayu Yang.
  16                                                                                                                                                                                                                                                            Join our Workshop on jsonlite: A Simple and Robust JSON Parser and Generator for R
  17                                                                                                                                                                                                                                                                                                                   Sofia Lai &amp; Marina Luna MPP
  18                                                                                                                                                                                                                                                                 Learn how to incorporate data from Web APIs into your data science workflow! 
  19                                                                                                                                                          This repository, by Caroline Cavallari and Jose de Los Heros, provides materials for learning how to connect to Web APIs, which will be presented as a workshop at the Hertie School
  20                                                                                                                                                                                                                      Through this presentation, Elena and I will introduce you to stringr package and some cool string manipulation exercises
```

```r
&gt; # Make sure to check out the other workshops, too!
```

---

# Key functions: `toJSON`


```r
&gt; starwars %&gt;% slice_sample(n = 2) %&gt;% 
+   toJSON(pretty = T)
```

```
  [
    {
      "name": "Cordé",
      "height": 157,
      "hair_color": "brown",
      "skin_color": "light",
      "eye_color": "brown",
      "sex": "female",
      "gender": "feminine",
      "homeworld": "Naboo",
      "species": "Human",
      "films": ["Attack of the Clones"],
      "vehicles": [],
      "starships": []
    },
    {
      "name": "Dud Bolt",
      "height": 94,
      "mass": 45,
      "hair_color": "none",
      "skin_color": "blue, grey",
      "eye_color": "yellow",
      "sex": "male",
      "gender": "masculine",
      "homeworld": "Vulpter",
      "species": "Vulptereen",
      "films": ["The Phantom Menace"],
      "vehicles": [],
      "starships": []
    }
  ]
```

---

R knows different `NA`-values, but JSON only has `null` to represent those...

- By default, `NA`'s are treated as strings (in numeric vectors)
  - so the string is no longer homogeneous, cause errors in statistical operations
  - but all information is preserved 
  

```r
&gt; (toJSON(c(3.14, NA, NaN, 21, Inf, -Inf)))
```

```
  [3.14,"NA","NaN",21,"Inf","-Inf"]
```
  
- You can choose to represent them as null
  - keeping the vector numeric
  - but loosing information


```r
&gt; (toJSON(c(3.14, NA, NaN, 21, Inf, -Inf), na = "null"))
```

```
  [3.14,null,null,21,null,null]
```



---

## Changing back and forth

- Note that there is no guaranteed one-to-one correspondence of R and JSON objects:
  - it will still be the encoded data
  - but ordering, class, etc. may differ


```r
&gt; (example &lt;- slice_sample(starwars, n = 2))
```

```
  # A tibble: 2 x 14
    name       height  mass hair_color skin_color eye_color birth_year sex   gender
    &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
  1 Jocasta Nu    167    NA white      fair       blue              NA fema~ femin~
  2 Yoda           66    17 white      green      brown            896 male  mascu~
  # ... with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
  #   vehicles &lt;list&gt;, starships &lt;list&gt;
```

```r
&gt; fromJSON(toJSON(example))
```

```
          name height hair_color skin_color eye_color    sex    gender homeworld
  1 Jocasta Nu    167      white       fair      blue female  feminine Coruscant
  2       Yoda     66      white      green     brown   male masculine      &lt;NA&gt;
           species
  1          Human
  2 Yoda's species
                                                                                                         films
  1                                                                                       Attack of the Clones
  2 The Empire Strikes Back, Attack of the Clones, The Phantom Menace, Revenge of the Sith, Return of the Jedi
    vehicles starships mass birth_year
  1     NULL      NULL   NA         NA
  2     NULL      NULL   17        896
```

if you - for whatever reason - need it to be consistent, use `(un)serializeJSON` instead

```r
&gt; unserializeJSON(serializeJSON(example))
```

```
  # A tibble: 2 x 14
    name       height  mass hair_color skin_color eye_color birth_year sex   gender
  * &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
  1 Jocasta Nu    167    NA white      fair       blue              NA fema~ femin~
  2 Yoda           66    17 white      green      brown            896 male  mascu~
  # ... with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
  #   vehicles &lt;list&gt;, starships &lt;list&gt;
```

But the downside is that the JSON structure has to be much harder to read (or transfer to other languages), to perfectly resemble the original...


```r
&gt; serializeJSON(example)
```

```
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","height","mass","hair_color","skin_color","eye_color","birth_year","sex","gender","homeworld","species","films","vehicles","starships"]},"row.names":{"type":"integer","attributes":{},"value":[1,2]},"class":{"type":"character","attributes":{},"value":["tbl_df","tbl","data.frame"]}},"value":[{"type":"character","attributes":{},"value":["Jocasta Nu","Yoda"]},{"type":"integer","attributes":{},"value":[167,66]},{"type":"double","attributes":{},"value":["NA",17]},{"type":"character","attributes":{},"value":["white","white"]},{"type":"character","attributes":{},"value":["fair","green"]},{"type":"character","attributes":{},"value":["blue","brown"]},{"type":"double","attributes":{},"value":["NA",896]},{"type":"character","attributes":{},"value":["female","male"]},{"type":"character","attributes":{},"value":["feminine","masculine"]},{"type":"character","attributes":{},"value":["Coruscant",null]},{"type":"character","attributes":{},"value":["Human","Yoda's species"]},{"type":"list","attributes":{},"value":[{"type":"character","attributes":{},"value":["Attack of the Clones"]},{"type":"character","attributes":{},"value":["The Empire Strikes Back","Attack of the Clones","The Phantom Menace","Revenge of the Sith","Return of the Jedi"]}]},{"type":"list","attributes":{},"value":[{"type":"character","attributes":{},"value":[]},{"type":"character","attributes":{},"value":[]}]},{"type":"list","attributes":{},"value":[{"type":"character","attributes":{},"value":[]},{"type":"character","attributes":{},"value":[]}]}]}
```


---
# Practice Example


```r
&gt; # Pokedex_JSON
&gt; # Pokedex_df
&gt; 
&gt; # some_funny_analysis
```

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
